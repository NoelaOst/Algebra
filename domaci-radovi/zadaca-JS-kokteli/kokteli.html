<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kokteli</title>
    <style>
      *,
      ::after,
      ::before {
        box-sizing: border-box;
        margin: 0%;
        padding: 0%;
      }
      body {
        font-family: "Franklin Gothic Medium", "Arial Narrow", Arial, sans-serif;
        margin: 1rem;
      }
      header {
        display: flex;
        justify-content: center;
      }
      h1 {
        display: flex;
        justify-content: center;
        text-align: center;
        border: 3px solid black;
        border-radius: 10px;
        width: 30vw;
        padding: 0.5rem;
      }
      .main-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-top: 2rem;
        flex-direction: column;
      }
      .search-wrapper {
        display: flex;
        flex-direction: row;
        margin-bottom: 3rem;
      }
      #search-btn {
        outline: none;
        background-color: black;
        color: white;
        border-radius: 40px;
        padding: 1rem;
        margin-inline: 1rem;
        font-weight: 600;
      }
      #search-btn:active {
        cursor: pointer;
        background-color: white;
        color: black;
      }
      #input {
        padding: 1rem;
        border-radius: 40px;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Cocktail Recipes</h1>
    </header>
    <div class="main-wrapper">
      <div class="search-wrapper">
        <input id="input" type="text" placeholder="Enter cocktail's name" />
        <button id="search-btn">Search</button>
      </div>
      <ul id="cocktail-list">
        <!-- we are going to render cocktail list here -->
      </ul>
    </div>
    <div id="bla-bla"></div>
    <ol id="ingredient-list"></ol>
    <script>
      const input = document.querySelector("#input");
      const searchBtn = document.querySelector("#search-btn");
      const cocktailList = document.querySelector("#cocktail-list");
      const blaDiv = document.querySelector("#bla-bla");
      const ingredientList = document.querySelector("#ingredient-list");

      const handleSearch = () => {
        // reset list by removing cocktailsList children
        // undefined === false
        while (cocktailList.lastElementChild) {
          cocktailList.removeChild(cocktailList.lastElementChild);
        }

        // call api to get cocktails
        const xhr = new XMLHttpRequest();
        xhr.open(
          "GET",
          `https://www.thecocktaildb.com/api/json/v1/1/search.php?s=${input.value}`
        );
        xhr.responseType = "json";
        xhr.send();

        // create list elements and assign drinks values
        xhr.onload = () => {
          const response = xhr.response.drinks;
          console.log(response);
          // const cocktailsData = response.drinks.map(drink => drink.strDrink)

          response.forEach((cocktail) => {
            const cocktailEntry = document.createElement("li"); // <li></li>

            cocktailEntry.appendChild(
              document.createTextNode(cocktail.strDrink)
            ); // <li>Mojito</li>

            cocktailList.appendChild(cocktailEntry);
            /*
            <ul>
              <li>Mojito</li>
              <li>SuperMojito</li>
            </ul>
            */

            cocktailEntry.addEventListener("click", () => {
              // remove previously added elements
              while (blaDiv.lastElementChild) {
                blaDiv.removeChild(blaDiv.lastElementChild);
              }
              while (ingredientList.lastElementChild) {
                ingredientList.removeChild(ingredientList.lastElementChild);
              }

              const cocktailDetails = document.createElement("h1"); // <p></p>
              cocktailDetails.appendChild(
                document.createTextNode(cocktail.strDrink)
              ); // <p>Mojito</p>

              const cocktailImage = document.createElement("img"); // <img />
              cocktailImage.src = cocktail.strDrinkThumb; // <img src="www.image.com" />

              const cocktailIngredientList = document.createElement("h2");
              cocktailIngredientList.innerText = "Ingredients:";

              const cocktailIngredient1 = document.createElement("li");
              cocktailIngredient1.appendChild(
                document.createTextNode(cocktail.strIngredient1)
              );
              const cocktailIngredient2 = document.createElement("li");
              cocktailIngredient2.appendChild(
                document.createTextNode(cocktail.strIngredient2)
              );
              const cocktailIngredient3 = document.createElement("li");
              cocktailIngredient3.appendChild(
                document.createTextNode(cocktail.strIngredient3)
              );
              const cocktailIngredient4 = document.createElement("li");
              cocktailIngredient4.appendChild(
                document.createTextNode(cocktail.strIngredient4)
              );

              blaDiv.appendChild(cocktailDetails);
              blaDiv.appendChild(cocktailImage);
              blaDiv.appendChild(cocktailIngredientList);
              ingredientList.appendChild(cocktailIngredient1);
              ingredientList.appendChild(cocktailIngredient2);
              ingredientList.appendChild(cocktailIngredient3);
              ingredientList.appendChild(cocktailIngredient4);
              /*
              <div>
                <p>Mojito</p>
                <img src="www.image.com" />
                <p>Tequila</p>
              </div>
              */
            });
            input.value = " ";
          });
        };
      };
      searchBtn.addEventListener("click", () => handleSearch());
      input.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          handleSearch();
        }
      });
    </script>
  </body>
</html>
